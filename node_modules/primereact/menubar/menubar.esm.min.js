import*as e from"react";import n,{PrimeReactContext as t,ariaLabel as r}from"primereact/api";import{ComponentBase as i,useHandleStyle as o}from"primereact/componentbase";import{useMergeProps as u,useEventListener as a,useResizeListener as c,useMountEffect as l,useUpdateEffect as s,useUnmountEffect as m}from"primereact/hooks";import{BarsIcon as f}from"primereact/icons/bars";import{classNames as p,ObjectUtils as d,IconUtils as b,DomHandler as v,UniqueComponentId as y,ZIndexUtils as g}from"primereact/utils";import{AngleDownIcon as x}from"primereact/icons/angledown";import{AngleRightIcon as I}from"primereact/icons/angleright";import{Ripple as h}from"primereact/ripple";function E(e){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E(e)}function k(e,n){if("object"!==E(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!==E(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}function S(e){var n=k(e,"string");return"symbol"===E(n)?n:String(n)}function w(e,n,t){return(n=S(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function O(e){if(Array.isArray(e))return e}function P(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,i,o,u,a=[],c=!0,l=!1;try{if(o=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;c=!1}else for(;!(c=(r=o.call(t)).done)&&(a.push(r.value),a.length!==n);c=!0);}catch(e){l=!0,i=e}finally{try{if(!c&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(l)throw i}}return a}}function N(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function K(e,n){if(e){if("string"==typeof e)return N(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?N(e,n):void 0}}function j(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function D(e,n){return O(e)||P(e,n)||K(e,n)||j()}var A=i.extend({defaultProps:{__TYPE:"Menubar",id:null,model:null,style:null,className:null,start:null,ariaLabel:null,ariaLabelledBy:null,onFocus:null,onBlur:null,submenuIcon:null,menuIcon:null,end:null,children:void 0},css:{classes:{start:"p-menubar-start",end:"p-menubar-end",button:"p-menubar-button",root:function(e){return p("p-menubar p-component",{"p-menubar-mobile-active":e.mobileActiveState})},separator:"p-menuitem-separator",icon:"p-menuitem-icon",label:"p-menuitem-text",submenuIcon:"p-submenu-icon",menuitem:function(e){return p("p-menuitem",{"p-menuitem-active p-highlight":e.active,"p-focus":e.focused,"p-disabled":e.disabled})},menu:"p-menubar-root-list",content:"p-menuitem-content",submenu:"p-submenu-list",action:function(e){return p("p-menuitem-link",{"p-disabled":e.disabled})}},styles:"\n@layer primereact {\n    .p-menubar {\n        display: flex;\n        align-items: center;\n    }\n\n    .p-menubar ul {\n        margin: 0;\n        padding: 0;\n        list-style: none;\n    }\n\n    .p-menubar .p-menuitem-link {\n        cursor: pointer;\n        display: flex;\n        align-items: center;\n        text-decoration: none;\n        overflow: hidden;\n        position: relative;\n    }\n\n    .p-menubar .p-menuitem-text {\n        line-height: 1;\n    }\n\n    .p-menubar .p-menuitem {\n        position: relative;\n    }\n\n    .p-menubar-root-list {\n        display: flex;\n        align-items: center;\n        flex-wrap: wrap;\n    }\n\n    .p-menubar-root-list > li ul {\n        display: none;\n        z-index: 1;\n    }\n\n    .p-menubar-root-list > .p-menuitem-active > .p-submenu-list {\n        display: block;\n    }\n\n    .p-menubar .p-submenu-list {\n        display: none;\n        position: absolute;\n        z-index: 1;\n    }\n\n    .p-menubar .p-submenu-list > .p-menuitem-active > .p-submenu-list {\n        display: block;\n        left: 100%;\n        top: 0;\n    }\n\n    .p-menubar .p-submenu-list .p-menuitem .p-menuitem-content .p-menuitem-link .p-submenu-icon {\n        margin-left: auto;\n    }\n\n    .p-menubar .p-menubar-end {\n        margin-left: auto;\n        align-self: center;\n    }\n\n    .p-menubar-button {\n        display: none;\n        cursor: pointer;\n        align-items: center;\n        justify-content: center;\n        text-decoration: none;\n    }\n}\n"}});function C(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function L(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?C(Object(t),!0).forEach((function(n){w(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):C(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var M=e.memo(e.forwardRef((function(n,t){var r=u(),i=n.ptm,o=n.cx,a=function(e,t,r){return i(t,{props:n,hostName:n.hostName,context:{item:e,index:r,active:v(e),focused:E(e),disabled:g(e),level:n.level}})},c=function(e,t){g(t)||n.mobileActive?e.preventDefault():n.onItemMouseEnter&&n.onItemMouseEnter({originalEvent:e,processedItem:t})},l=function(e,n){var t=n.item;g(n)?e.preventDefault():(t.url||e.preventDefault(),t.command&&t.command({originalEvent:e,item:t}),s({originalEvent:e,processedItem:n,isFocus:!0}))},s=function(e){n.onLeafClick&&n.onLeafClick(e)},m=function(e){return"".concat(n.id,"_").concat(e.key)},f=function(e,n,t){return e&&e.item?d.getItemValue(e.item[n],t):void 0},v=function(e){return n.activeItemPath.some((function(n){return n.key===e.key}))},y=function(e){return!1!==f(e,"visible")},g=function(e){return f(e,"disabled")},E=function(e){return n.focusedItemId===m(e)},k=function(e){return d.isNotEmpty(e.items)},S=function(e){return e-n.model.slice(0,e).filter((function(e){return y(e)&&f(e,"separator")})).length+1},O=function(t){var u=n.id+"_separator_"+t,a=r({id:u,key:u,className:o("separator"),role:"separator"},i("separator",{hostName:n.hostName}));return e.createElement("li",a)},P=function(t){var r=t&&t.items;return r?e.createElement(M,{id:n.id,hostName:n.hostName,menuProps:n.menuProps,level:n.level+1,model:r,activeItemPath:n.activeItemPath,focusedItemId:n.focusedItemId,onLeafClick:s,onItemMouseEnter:n.onItemMouseEnter,submenuIcon:n.submenuIcon,ptm:i,style:{display:v(t)?"block":"none"},cx:o}):null},N=function(t,i){var u=t.item;if(!y(t))return null;var s=m(t),O=v(t),N=E(t),K=g(t)||!1,j=k(t),D=p("p-menuitem-link",{"p-disabled":K}),A=p("p-menuitem-icon",f(t,"icon")),C=r({className:o("icon")},a(t,"icon",i)),M=b.getJSXIcon(u.icon,L({},C),{props:n.menuProps}),T=r({className:o("label")},a(t,"label",i)),R=u.label&&e.createElement("span",T,u.label),B=f(t,"items"),F=r({className:o("submenuIcon")},a(t,"submenuIcon",i)),_=B&&b.getJSXIcon(n.root?n.submenuIcon||e.createElement(x,F):n.submenuIcon||e.createElement(I,F),L({},F),{props:L({menuProps:n.menuProps},n)}),J=P(t),X=r({href:u.url||"#",tabIndex:"-1","aria-hidden":"true",className:o("action",{disabled:K}),onFocus:function(e){return e.stopPropagation()},target:f(t,"target"),"aria-haspopup":null!=B},a(t,"action",i)),z=e.createElement("a",X,M,R,_,e.createElement(h,null));u.template&&(z=d.getJSXElement(u.template,u,{className:D,labelClassName:"p-menuitem-text",iconClassName:A,submenuIconClassName:"p-submenu-icon",element:z,props:n}));var U=r({onClick:function(e){return l(e,t)},onMouseEnter:function(e){return c(e,t)},className:o("content")},a(t,"content",i)),V=f(t,"className"),H=r(w({id:s,key:s,role:"menuitem","aria-label":u.label,"aria-disabled":K,"aria-expanded":j?O:void 0,"aria-haspopup":j&&!u.url?"menu":void 0,"aria-level":n.level+1,"aria-setsize":n.model.filter((function(e){return y(e)&&!f(e,"separator")})).length,"aria-posinset":S(i),"data-p-highlight":O,"data-p-focused":N,"data-p-disabled":K,className:p(V,o("menuitem",{active:O,focused:N,disabled:K}))},"data-p-disabled",K||!1),a(t,"menuitem",i));return e.createElement("li",H,e.createElement("div",U,z),J)},K=n.root?"menubar":"menu",j=n.root?"menu":"submenu",D=n.root?"0":null,A=n.model?n.model.map((function(e,n){return f(e,"separator")?O(n):N(e,n)})):null,C=r({ref:t,className:o(j),level:n.level,onFocus:n.onFocus,onBlur:n.onBlur,onKeyDown:n.onKeyDown,id:n.id,tabIndex:D,"aria-activedescendant":n.ariaActivedescendant,style:n.style,role:K},i(j));return e.createElement("ul",C,A)})));function T(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function R(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?T(Object(t),!0).forEach((function(n){w(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):T(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}M.displayName="MenubarSub";var B=e.memo(e.forwardRef((function(i,x){var I=u(),h=e.useContext(t),E=A.getProps(i,h),k=D(e.useState(E.id),2),S=k[0],O=k[1],P=D(e.useState(!1),2),N=P[0],K=P[1],j=D(e.useState(!1),2),C=j[0],L=j[1],T=D(e.useState({index:-1,level:0,parentKey:""}),2),B=T[0],F=T[1],_=D(e.useState(null),2),J=_[0],X=_[1],z=D(e.useState([]),2),U=z[0],V=z[1],H=D(e.useState([]),2),W=H[0],Z=H[1],Y=D(e.useState([]),2),$=Y[0],q=Y[1],G=D(e.useState(!1),2),Q=G[0],ee=G[1],ne=D(e.useState(!1),2),te=ne[0],re=ne[1],ie=e.useRef(null),oe=e.useRef(null),ue=e.useRef(null),ae=e.useRef(""),ce=e.useRef(null),le=e.useRef(!1),se=A.setMetaData({props:E,state:{id:S,mobileActive:N}}),me=se.ptm,fe=se.cx;o(A.css.styles,se.isUnstyled,{name:"menubar"});var pe=D(a({type:"click",listener:function(e){Ee(e)&&(ie.current&&!ie.current.contains(e.target)&&he())}}),2),de=pe[0],be=pe[1],ve=D(c({listener:function(e){v.isTouchDevice()||he(e)}}),2),ye=ve[0],ge=ve[1],xe=function(e){N?(K(!1),he()):(K(!0),setTimeout((function(){Ie()}),1)),e.preventDefault()},Ie=function(){F({index:We(),level:0,parentKey:""}),v.focus(oe.current)},he=function(e){N&&(K(!1),setTimeout((function(){v.focus(ue.current)}),0)),V([]),F({index:-1,level:0,parentKey:""}),e&&v.focus(oe.current),re(!1)},Ee=function(e){return oe.current!==e.target&&!oe.current.contains(e.target)&&ue.current!==e.target&&!ue.current.contains(e.target)},ke=function(e,n){return e?d.getItemValue(e[n]):void 0},Se=function(e){return ke(e,"separator")},we=function(e){return e?ke(e.item,"label"):void 0},Oe=function(e){return e&&d.isNotEmpty(e.items)},Pe=function(e){var n=e.processedItem,t=e.isFocus;if(!d.isEmpty(n)){var r=n.index,i=n.key,o=n.level,u=n.parentKey,a=d.isNotEmpty(n.items),c=U.filter((function(e){return e.parentKey!==u&&e.parentKey!==i}));a&&c.push(n),F({index:r,level:o,parentKey:u}),V(c),a&&re(!0),t&&v.focus(oe.current)}},Ne=function(e){var n=W[B.index];if(n?d.isEmpty(n.parent):null){Oe(n)&&(Pe({originalEvent:e,processedItem:n}),F({index:-1,parentKey:n.key}),setTimeout((function(){return ee(!0)}),0))}else{var t=-1!==B.index?Ue(B.index):We();$e(t)}e.preventDefault()},Ke=function(e){var n=W[B.index];if(d.isEmpty(n.parent)){Oe(n)&&(Pe({originalEvent:e,processedItem:n}),F({index:-1,parentKey:n.key}),le.current=!0,setTimeout((function(){return ee(!0)}),0))}else{var t=U.find((function(e){return e.key===n.parentKey}));if(0===B.index&&t&&""===t.parentKey)F({index:-1,parentKey:t?t.parentKey:""}),ae.current="",je(e);else{var r=-1!==B.index?Ve(B.index):Ze();$e(r)}}e.preventDefault()},je=function(e){var n=W[B.index],t=n?U.find((function(e){return e.key===n.parentKey})):null;if(t)Pe({originalEvent:e,processedItem:t}),V(U.filter((function(e){return e.key!==t.key})));else{var r=-1!==B.index?Ve(B.index):Ze();$e(r)}e.preventDefault()},De=function(e){var n=W[B.index];if(n?U.find((function(e){return e.key===n.parentKey})):null){Oe(n)&&(Pe({originalEvent:e,processedItem:n}),F({index:-1,parentKey:n.key}),setTimeout((function(){return ee(!0)}),0))}else{var t=-1!==B.index?Ue(B.index):We();$e(t)}e.preventDefault()},Ae=function(e){$e(Xe()),e.preventDefault()},Ce=function(e){$e(ze()),e.preventDefault()},Le=function(e){if(-1!==B.index){var n=v.findSingle(oe.current,'li[id="'.concat("".concat(J),'"]')),t=n&&v.findSingle(n,'a[data-pc-section="action"]');t?t.click():n&&n.click()}e.preventDefault()},Me=function(e){Le(e)},Te=function(e){he(!0),F({focusedItemInfo:B,index:We()})},Re=function(e){if(-1!==B.index){var n=W[B.index];!Oe(n)&&Pe({originalEvent:e,processedItem:n})}he()},Be=function(e){return Fe(e)&&we(e).toLocaleLowerCase().startsWith(ae.current.toLocaleLowerCase())},Fe=function(e){return!!e&&!ke(e.item,"disabled")&&!Se(e.item)},_e=function(e){return Fe(e)&&Je(e)},Je=function(e){return U.some((function(n){return n.key===e.key}))},Xe=function(){return W.findIndex((function(e){return Fe(e)}))},ze=function(){return d.findLastIndex(W,(function(e){return Fe(e)}))},Ue=function(e){var n=e<W.length-1?W.slice(e+1).findIndex((function(e){return Fe(e)})):-1;return n>-1?n+e+1:e},Ve=function(e){var n=e>0?d.findLastIndex(W.slice(0,e),(function(e){return Fe(e)})):-1;return n>-1?n:e},He=function(){return W.findIndex((function(e){return _e(e)}))},We=function(){var e=He();return e<0?Xe():e},Ze=function(){var e=He();return e<0?ze():e},Ye=function(e,n){ae.current=(ae.current||"")+n;var t=-1,r=!1;return-1!==(t=-1!==B.index?-1===(t=W.slice(B.index).findIndex((function(e){return Be(e)})))?W.slice(0,B.index).findIndex((function(e){return Be(e)})):t+B.index:W.findIndex((function(e){return Be(e)})))&&(r=!0),-1===t&&-1===B.index&&(t=We()),-1!==t&&$e(t),ce.current&&clearTimeout(ce.current),ce.current=setTimeout((function(){ae.current="",ce.current=null}),500),r},$e=function(e){B.index!==e&&(F(R(R({},B),{},{index:e})),qe())},qe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,n=-1!==e?"".concat(S,"_").concat(e):J,t=v.findSingle(oe.current,'li[id="'.concat(n,'"]'));t&&t.scrollIntoView&&t.scrollIntoView({block:"nearest",inline:"start"})},Ge=e.useCallback((function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=[];return e&&e.forEach((function(e,o){var u=(""!==r?r+"_":"")+o,a={item:e,index:o,level:n,key:u,parent:t,parentKey:r};a.items=Ge(e.items,n+1,a,u),i.push(a)})),i}),[]);l((function(){S||O(y())})),s((function(){N?(de(),ye(),g.set("menu",oe.current,h&&h.autoZIndex||n.autoZIndex,h&&h.zIndex.menu||n.zIndex.menu)):(ge(),be(),g.clear(oe.current))}),[N]),e.useEffect((function(){var e=Ge(E.model||[],0,null,"");q(e)}),[E.model,Ge]),s((function(){var e=U.find((function(e){return e.key===B.parentKey}));Z(e?e.items:$)}),[U,B,$]),s((function(){d.isNotEmpty(U)?(de(),ye()):(be(),ge())}),[U]),s((function(){if(Q){var e=-1!==B.index?Ue(B.index):le.current?ze():We();$e(e),le.current=!1,ee(!1)}}),[Q]),s((function(){X(-1!==B.index?"".concat(S).concat(d.isNotEmpty(B.parentKey)?"_"+B.parentKey:"","_").concat(B.index):null)}),[B]),m((function(){g.clear(oe.current)})),e.useImperativeHandle(x,(function(){return{props:E,toggle:xe,getElement:function(){return ie.current},getRootMenu:function(){return oe.current},getMenuButton:function(){return ue.current}}}));var Qe=function(){if(E.start){var n=d.getJSXElement(E.start,E),t=I({className:fe("start")},me("start"));return e.createElement("div",t,n)}return null}(),en=function(){if(E.end){var n=d.getJSXElement(E.end,E),t=I({className:fe("end")},me("end"));return e.createElement("div",t,n)}return null}(),nn=function(){if(E.model&&E.model.length<1)return null;var n=I(w(w(w(w({ref:ue,href:"#",tabIndex:"0","aria-haspopup":!!(N&&E.model&&E.model.lentgh>0),"aria-expanded":N,"aria-label":r("navigation"),"aria-controls":S,role:"button"},"tabIndex",0),"className",fe("button")),"onKeyDown",(function(e){var n;("Enter"===(n=e).code||"Space"===n.code)&&xe(n)})),"onClick",(function(e){return xe(e)})),me("button")),t=I(me("popupIcon")),i=b.getJSXIcon(E.menuIcon||e.createElement(f,t),R({},t),{props:E});return e.createElement("a",n,i)}(),tn=e.createElement(M,{hostName:"Menubar",ariaActivedescendant:C?J:void 0,level:0,id:S,ref:oe,menuProps:E,model:$,onLeafClick:function(e){var n=e.originalEvent,t=e.processedItem,r=Oe(t),i=d.isEmpty(t.parent);if(Je(t)){var o=t.index,u=t.key,a=t.level,c=t.parentKey;V(U.filter((function(e){return u!==e.key&&u.startsWith(e.key)}))),F({index:o,level:a,parentKey:c}),r||re(!i),setTimeout((function(){v.focus(oe.current),r&&re(!0)}),0)}else if(r)v.focus(oe.current),Pe({originalEvent:n,processedItem:t});else{var l=i?t:U.find((function(e){return""===e.parentKey})),s=l?l.index:-1;he(n),F({index:s,parentKey:l?l.parentKey:""}),K(!1)}},onItemMouseEnter:function(e){!N&&te&&Pe(e)},onFocus:function(e){L(!0),F(-1!==B.index?B:{index:We(),level:0,parentKey:""}),E.onFocus&&E.onFocus(e)},onBlur:function(e){L(!1),F({index:-1,level:0,parentKey:""}),ae.current="",re(!1),E.onBlur&&E.onBlur(e)},onKeyDown:function(e){var n=e.metaKey||e.ctrlKey;switch(e.code){case"ArrowDown":Ne(e);break;case"ArrowUp":Ke(e);break;case"ArrowLeft":je(e);break;case"ArrowRight":De(e);break;case"Home":Ae(e);break;case"End":Ce(e);break;case"Space":Me(e);break;case"Enter":Le(e);break;case"Escape":Te();break;case"Tab":Re(e);break;case"PageDown":case"PageUp":case"Backspace":case"ShiftLeft":case"ShiftRight":break;default:!n&&d.isPrintableCharacter(e.key)&&Ye(e,e.key)}},root:!0,activeItemPath:U,focusedItemId:C?J:void 0,submenuIcon:E.submenuIcon,ptm:me,cx:fe}),rn=I({id:E.id,ref:ie,className:p(E.className,fe("root",{mobileActiveState:N})),style:E.style},A.getOtherProps(E),me("root"));return e.createElement("div",rn,Qe,nn,tn,en)})));B.displayName="Menubar";export{B as Menubar};
