import*as e from"react";import{PrimeReactContext as n}from"primereact/api";import{ComponentBase as t,useHandleStyle as r}from"primereact/componentbase";import{useMergeProps as o}from"primereact/hooks";import{SearchIcon as l}from"primereact/icons/search";import{SpinnerIcon as a}from"primereact/icons/spinner";import{classNames as i,DomHandler as c,ObjectUtils as d,IconUtils as u}from"primereact/utils";import{CheckIcon as p}from"primereact/icons/check";import{ChevronDownIcon as s}from"primereact/icons/chevrondown";import{ChevronRightIcon as f}from"primereact/icons/chevronright";import{MinusIcon as g}from"primereact/icons/minus";import{Ripple as m}from"primereact/ripple";function h(){return h=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},h.apply(this,arguments)}function y(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function v(e){if(Array.isArray(e))return y(e)}function b(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function x(e,n){if(e){if("string"==typeof e)return y(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?y(e,n):void 0}}function S(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function k(e){return v(e)||b(e)||x(e)||S()}function E(e){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E(e)}function C(e,n){if("object"!==E(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!==E(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}function I(e){var n=C(e,"string");return"symbol"===E(n)?n:String(n)}function D(e,n,t){return(n=I(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function O(e){if(Array.isArray(e))return e}function w(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,o,l,a,i=[],c=!0,d=!1;try{if(l=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;c=!1}else for(;!(c=(r=l.call(t)).done)&&(i.push(r.value),i.length!==n);c=!0);}catch(e){d=!0,o=e}finally{try{if(!c&&null!=t.return&&(a=t.return(),Object(a)!==a))return}finally{if(d)throw o}}return i}}function T(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function N(e,n){return O(e)||w(e,n)||x(e,n)||T()}var K=t.extend({defaultProps:{__TYPE:"Tree",__parentMetadata:null,id:null,value:null,checkboxIcon:null,disabled:!1,selectionMode:null,selectionKeys:null,onSelectionChange:null,contextMenuSelectionKey:null,onContextMenuSelectionChange:null,expandedKeys:null,ariaLabel:null,ariaLabelledBy:null,style:null,className:null,contentStyle:null,contentClassName:null,metaKeySelection:!0,propagateSelectionUp:!0,propagateSelectionDown:!0,loading:!1,loadingIcon:null,expandIcon:null,collapseIcon:null,dragdropScope:null,header:null,footer:null,showHeader:!0,filter:!1,filterIcon:null,filterValue:null,filterBy:"label",filterMode:"lenient",filterPlaceholder:null,filterLocale:void 0,filterTemplate:null,level:0,nodeTemplate:null,togglerTemplate:null,onSelect:null,onUnselect:null,onExpand:null,onCollapse:null,onToggle:null,onDragDrop:null,onContextMenu:null,onFilterValueChange:null,onNodeClick:null,onNodeDoubleClick:null,children:void 0},css:{classes:{container:"p-tree-container",loadingIcon:"p-tree-loading-icon",loadingOverlay:"p-tree-loading-overlay p-component-overlay",searchIcon:"p-tree-filter-icon",filterContainer:"p-tree-filter-container",input:"p-tree-filter p-inputtext p-component",header:"p-tree-header",footer:"p-tree-footer",root:function(e){var n=e.props;return i("p-tree p-component",{"p-tree-selectable":n.selectionMode,"p-tree-loading":n.loading,"p-disabled":n.disabled})},label:"p-treenode-label",checkboxIcon:"p-checkbox-icon p-c",checkboxContainer:"p-checkbox p-component",checkbox:function(e){return i("p-checkbox-box",{"p-highlight":e.checked,"p-indeterminate":e.partialChecked,"p-disabled":e.nodeProps.disabled})},nodeIcon:"p-treenode-icon",togglerIcon:"p-tree-toggler-icon",toggler:"p-tree-toggler p-link",droppoint:"p-treenode-droppoint",content:function(e){var n=e.nodeProps,t=e.checked,r=e.selected;return i("p-treenode-content",{"p-treenode-selectable":n.selectionMode&&!1!==n.node.selectable,"p-highlight":(0,e.isCheckboxSelectionMode)()?t:r,"p-highlight-contextmenu":n.contextMenuSelectionKey&&n.contextMenuSelectionKey===n.node.key,"p-disabled":n.disabled})},subgroup:"p-treenode-children",node:function(e){return i("p-treenode",{"p-treenode-leaf":e.isLeaf})}},styles:"\n@layer primereact {\n    .p-tree-container {\n        margin: 0;\n        padding: 0;\n        list-style-type: none;\n        overflow: auto;\n    }\n\n    .p-treenode-children {\n        margin: 0;\n        padding: 0;\n        list-style-type: none;\n    }\n\n    .p-treenode-selectable {\n        cursor: pointer;\n        user-select: none;\n    }\n\n    .p-tree-toggler {\n        cursor: pointer;\n        user-select: none;\n        display: inline-flex;\n        align-items: center;\n        justify-content: center;\n        flex-shrink: 0;\n        overflow: hidden;\n        position: relative;\n    }\n\n    .p-treenode-leaf > .p-treenode-content .p-tree-toggler {\n        visibility: hidden;\n    }\n\n    .p-treenode-content {\n        display: flex;\n        align-items: center;\n    }\n\n    .p-tree-filter {\n        width: 100%;\n    }\n\n    .p-tree-filter-container {\n        position: relative;\n        display: block;\n        width: 100%;\n    }\n\n    .p-tree-filter-icon {\n        position: absolute;\n        top: 50%;\n        margin-top: -.5rem;\n    }\n\n    .p-tree-loading {\n        position: relative;\n        min-height: 4rem;\n    }\n\n    .p-tree .p-tree-loading-overlay {\n        position: absolute;\n        z-index: 1;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n    }\n}\n"}});function M(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=P(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,a=!0,i=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return a=e.done,e},e:function(e){i=!0,l=e},f:function(){try{a||null==t.return||t.return()}finally{if(i)throw l}}}}function P(e,n){if(e){if("string"==typeof e)return j(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?j(e,n):void 0}}function j(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function A(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function U(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?A(Object(t),!0).forEach((function(n){D(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):A(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var L=e.memo((function(n){var t,r,l,a,h,y,v,b=e.useRef(null),x=e.useRef(null),S=e.useRef(!1),E=o(),C=n.isNodeLeaf(n.node),I=n.node.label,O=!!n.expandedKeys&&void 0!==n.expandedKeys[n.node.key]||n.node.expanded,w=n.ptm,T=n.cx,N=function(e){return w(e,{hostName:n.hostName,context:{selected:!ce()&&re(),expanded:O||!1,checked:!!ce()&&oe(),isLeaf:C}})},K=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=n.expandedKeys?U({},n.expandedKeys):{};r[n.node.key]=!0,n.onToggle({originalEvent:e,value:r,navigateFocusToChild:t}),A(e,!0)},P=function(e){var t=U({},n.expandedKeys);delete t[n.node.key],n.onToggle({originalEvent:e,value:t}),A(e,!1)},j=function(e){n.disabled||(O?P(e):K(e,!1),e.preventDefault(),e.stopPropagation())},A=function(e,t){t?n.onExpand&&n.onExpand({originalEvent:e,node:n.node}):n.onCollapse&&n.onCollapse({originalEvent:e,node:n.node})},R=function e(n){var t=J(n);return t?t.nextElementSibling||e(t):null},F=function e(n){var t=n.children[1];return t?e(t.children[t.children.length-1]):n},J=function(e){var n=e.parentElement.parentElement;return c.hasClass(n,"p-treenode")?n:null},X=function(e){n.onClick&&n.onClick({originalEvent:e,node:n.node});var t=e.target.nodeName;if(!n.disabled&&"INPUT"!==t&&"BUTTON"!==t&&"A"!==t&&!c.hasClass(e.target,"p-clickable")){if(n.selectionMode&&!1!==n.node.selectable){var r;if(ce()){var o=oe();r=n.selectionKeys?U({},n.selectionKeys):{},o?(n.propagateSelectionDown?te(n.node,!1,r):delete r[n.node.key],n.propagateSelectionUp&&n.onPropagateUp&&n.onPropagateUp({originalEvent:e,check:!1,selectionKeys:r}),n.onUnselect&&n.onUnselect({originalEvent:e,node:n.node})):(n.propagateSelectionDown?te(n.node,!0,r):r[n.node.key]={checked:!0},n.propagateSelectionUp&&n.onPropagateUp&&n.onPropagateUp({originalEvent:e,check:!0,selectionKeys:r}),n.onSelect&&n.onSelect({originalEvent:e,node:n.node}))}else{var l=re();if(!S.current&&n.metaKeySelection){var a=e.metaKey||e.ctrlKey;l&&a?(ae()?r=null:delete(r=U({},n.selectionKeys))[n.node.key],n.onUnselect&&n.onUnselect({originalEvent:e,node:n.node})):(ae()?r=n.node.key:ie()&&((r=a&&n.selectionKeys?U({},n.selectionKeys):{})[n.node.key]=!0),n.onSelect&&n.onSelect({originalEvent:e,node:n.node}))}else ae()?l?(r=null,n.onUnselect&&n.onUnselect({originalEvent:e,node:n.node})):(r=n.node.key,n.onSelect&&n.onSelect({originalEvent:e,node:n.node})):l?(delete(r=U({},n.selectionKeys))[n.node.key],n.onUnselect&&n.onUnselect({originalEvent:e,node:n.node})):((r=n.selectionKeys?U({},n.selectionKeys):{})[n.node.key]=!0,n.onSelect&&n.onSelect({originalEvent:e,node:n.node}))}n.onSelectionChange&&n.onSelectionChange({originalEvent:e,value:r})}S.current=!1}},B=function(e){n.onDoubleClick&&n.onDoubleClick({originalEvent:e,node:n.node})},V=function(e){n.disabled||(c.clearSelection(),n.onContextMenuSelectionChange&&n.onContextMenuSelectionChange({originalEvent:e,value:n.node.key}),n.onContextMenu&&n.onContextMenu({originalEvent:e,node:n.node}))},_=function(e){if(le(e))switch(e.code){case"Tab":G();break;case"ArrowDown":H(e);break;case"ArrowUp":$(e);break;case"ArrowRight":z(e);break;case"ArrowLeft":Y(e);break;case"Enter":case"NumpadEnter":case"Space":q(e)}},H=function(e){var n="toggler"===e.target.getAttribute("data-pc-section")?e.target.closest('[role="treeitem"]'):e.target,t=n.children[1];if(t)Z(n,t.children[0]);else if(n.nextElementSibling)Z(n,n.nextElementSibling);else{var r=R(n);r&&Z(n,r)}e.preventDefault()},$=function(e){var n=e.target;if(n.previousElementSibling)Z(n,n.previousElementSibling,F(n.previousElementSibling));else{var t=J(n);t&&Z(n,t)}e.preventDefault()},z=function(e){C||O||(e.currentTarget.tabIndex=-1,K(e,!0))},Y=function(e){var t=c.findSingle(e.currentTarget,'[data-pc-section="toggler"]');if(0===n.level&&!O)return!1;if(O&&!C)return t.click(),!1;var r=ee(e.currentTarget);r&&Z(e.currentTarget,r)},q=function(e){W(e,S.current),X(e),e.preventDefault()},G=function(){Q()},Q=function(){var e=c.find(b.current.closest('[data-pc-section="container"]'),'[role="treeitem"]'),n=k(e).some((function(e){return"true"===e.getAttribute("aria-selected")||"true"===e.getAttribute("aria-checked")}));if(k(e).forEach((function(e){e.tabIndex=-1})),n){var t=k(e).filter((function(e){return"true"===e.getAttribute("aria-selected")||"true"===e.getAttribute("aria-checked")}));t[0].tabIndex=0}else k(e)[0].tabIndex=0},W=function(e,t){if(null!==n.selectionMode){var r=k(c.find(x.current.parentElement,'[role="treeitem"]'));e.currentTarget.tabIndex=!1===t?-1:0,r.every((function(e){return-1===e.tabIndex}))&&(r[0].tabIndex=0)}},Z=function(e,n,t){var r;e.tabIndex="-1",n.tabIndex="0",(r=t||n)&&r.focus()},ee=function e(n){var t=n.closest("ul").closest("li");if(t){var r=c.findSingle(t,"button");return r&&"hidden"!==r.style.visibility?t:e(n.previousElementSibling)}return null},ne=function(e){var t,r=e.check,o=e.selectionKeys,l=M(n.node.children);try{for(l.s();!(t=l.n()).done;){var a=t.value;o[a.key]&&o[a.key].checked&&0}}catch(e){l.e(e)}finally{l.f()}var i=n.node.key,c=d.findChildrenByKey(n.originalOptions,i),u=c.some((function(e){return e.key in o})),p=c.every((function(e){return e.key in o&&o[e.key].checked}));u&&!p?o[i]={checked:!1,partialChecked:!0}:p?o[i]={checked:!0,partialChecked:!1}:r?o[i]={checked:!1,partialChecked:!1}:delete o[i],n.propagateSelectionUp&&n.onPropagateUp&&n.onPropagateUp(e)},te=function e(n,t,r){if(t?r[n.key]={checked:!0,partialChecked:!1}:delete r[n.key],n.children&&n.children.length)for(var o=0;o<n.children.length;o++)e(n.children[o],t,r)},re=function(){return!(!n.selectionMode||!n.selectionKeys)&&(ae()?n.selectionKeys===n.node.key:void 0!==n.selectionKeys[n.node.key])},oe=function(){return!!n.selectionKeys&&(n.selectionKeys[n.node.key]&&n.selectionKeys[n.node.key].checked)||!1},le=function(e){return e.currentTarget&&(e.currentTarget.isSameNode(e.target)||e.currentTarget.isSameNode(e.target.closest('[role="treeitem"]')))},ae=function(){return n.selectionMode&&"single"===n.selectionMode},ie=function(){return n.selectionMode&&"multiple"===n.selectionMode},ce=function(){return n.selectionMode&&"checkbox"===n.selectionMode},de=function(){S.current=!0},ue=function(e,t){(e.preventDefault(),!1!==n.node.droppable)&&(c.removeClass(e.target,"p-treenode-droppoint-active"),n.onDropPoint&&n.onDropPoint({originalEvent:e,path:n.path,index:-1===t?n.index:n.index+1,position:t}))},pe=function(e){e.dataTransfer.types[1]===n.dragdropScope.toLocaleLowerCase()&&(e.dataTransfer.dropEffect="move",e.preventDefault())},se=function(e){e.dataTransfer.types[1]===n.dragdropScope.toLocaleLowerCase()&&c.addClass(e.target,"p-treenode-droppoint-active")},fe=function(e){e.dataTransfer.types[1]===n.dragdropScope.toLocaleLowerCase()&&c.removeClass(e.target,"p-treenode-droppoint-active")},ge=function(e){n.dragdropScope&&!1!==n.node.droppable&&(c.removeClass(b.current,"p-treenode-dragover"),e.preventDefault(),e.stopPropagation(),n.onDrop&&n.onDrop({originalEvent:e,path:n.path,index:n.index}))},me=function(e){e.dataTransfer.types[1]===n.dragdropScope.toLocaleLowerCase()&&!1!==n.node.droppable&&(e.dataTransfer.dropEffect="move",e.preventDefault(),e.stopPropagation())},he=function(e){e.dataTransfer.types[1]===n.dragdropScope.toLocaleLowerCase()&&!1!==n.node.droppable&&c.addClass(b.current,"p-treenode-dragover")},ye=function(e){if(e.dataTransfer.types[1]===n.dragdropScope.toLocaleLowerCase()&&!1!==n.node.droppable){var t=e.currentTarget.getBoundingClientRect();(e.nativeEvent.x>t.left+t.width||e.nativeEvent.x<t.left||e.nativeEvent.y>=Math.floor(t.top+t.height)||e.nativeEvent.y<t.top)&&c.removeClass(b.current,"p-treenode-dragover")}},ve=function(e){e.dataTransfer.setData("text",n.dragdropScope),e.dataTransfer.setData(n.dragdropScope,n.dragdropScope),n.onDragStart&&n.onDragStart({originalEvent:e,path:n.path,index:n.index})},be=function(e){n.onDragEnd&&n.onDragEnd({originalEvent:e})},xe=function(){var t=E({className:T("label")},N("label")),r=e.createElement("span",t,I);n.nodeTemplate&&(r=d.getJSXElement(n.nodeTemplate,n.node,{onTogglerClick:j,className:"p-treenode-label",element:r,props:n,expanded:O}));return r},Se=function(){if(ce()&&!1!==n.node.selectable){var t=oe(),r=!!n.selectionKeys&&n.selectionKeys[n.node.key]&&n.selectionKeys[n.node.key].partialChecked,o=E({className:T("checkboxIcon")},N("checkboxIcon")),l=u.getJSXIcon(t?n.checkboxIcon||e.createElement(p,o):r?n.checkboxIcon||e.createElement(g,o):null,U({},o),n),a=E({"aria-hidden":!0,className:T("checkboxContainer")},N("checkboxContainer")),i=E({className:T("checkbox",{checked:t,partialChecked:r,nodeProps:n}),role:"checkbox"},N("checkbox"));return e.createElement("div",a,e.createElement("div",i,l))}return null},ke=function(){var t=n.node.icon||(O?n.node.expandedIcon:n.node.collapsedIcon);if(t){var r=E({className:i(t,T("nodeIcon"))},N("nodeIcon"));return e.createElement("span",r)}return null},Ee=function(){var t=E({className:T("togglerIcon"),"aria-hidden":!0},N("togglerIcon")),r=u.getJSXIcon(O?n.collapseIcon||e.createElement(s,t):n.expandIcon||e.createElement(f,t),U({},t),{props:n,expanded:O}),o=E({type:"button",className:T("toggler"),tabIndex:-1,"aria-hidden":!0,onClick:j},N("toggler")),l=e.createElement("button",o,r,e.createElement(m,null));n.togglerTemplate&&(l=d.getJSXElement(n.togglerTemplate,n.node,{onClick:j,containerClassName:"p-tree-toggler p-link",iconClassName:"p-tree-toggler-icon",element:l,props:n,expanded:O}));return l},Ce=function(t){if(n.dragdropScope){var r=E({className:T("droppoint"),onDrop:function(e){return ue(e,t)},onDragOver:pe,onDragEnter:se,onDragLeave:fe},N("droppoint"));return e.createElement("li",r)}return null},Ie=function(){var t=re(),r=oe(),o=Ee(),l=Se(),a=ke(),c=xe(),d=E({ref:b,className:i(n.node.className,T("content",{checked:r,selected:t,nodeProps:n,isCheckboxSelectionMode:ce})),style:n.node.style,onClick:X,onDoubleClick:B,onContextMenu:V,onTouchEnd:de,draggable:n.dragdropScope&&!1!==n.node.draggable&&!n.disabled,onDrop:ge,onDragOver:me,onDragEnter:he,onDragLeave:ye,onDragStart:ve,onDragEnd:be,"data-p-highlight":ce()?r:t},N("content"));return e.createElement("div",d,o,l,a,c)},De=(r=n.disabled||0!==n.index?-1:0,l=re(),a=oe(),h=Ie(),t=E({className:T("subgroup"),role:"group"},N("subgroup")),y=d.isNotEmpty(n.node.children)&&O?e.createElement("ul",t,n.node.children.map((function(t,r){return e.createElement(L,{key:t.key||t.label,node:t,checkboxIcon:n.checkboxIcon,collapseIcon:n.collapseIcon,contextMenuSelectionKey:n.contextMenuSelectionKey,cx:T,disabled:n.disabled,dragdropScope:n.dragdropScope,expandIcon:n.expandIcon,expandedKeys:n.expandedKeys,index:r,isNodeLeaf:n.isNodeLeaf,last:r===n.node.children.length-1,metaKeySelection:n.metaKeySelection,nodeTemplate:n.nodeTemplate,onClick:n.onClick,onCollapse:n.onCollapse,onContextMenu:n.onContextMenu,onContextMenuSelectionChange:n.onContextMenuSelectionChange,onDoubleClick:n.onDoubleClick,onDragEnd:n.onDragEnd,onDragStart:n.onDragStart,onDrop:n.onDrop,onDropPoint:n.onDropPoint,onExpand:n.onExpand,onPropagateUp:ne,onSelect:n.onSelect,onSelectionChange:n.onSelectionChange,onToggle:n.onToggle,onUnselect:n.onUnselect,originalOptions:n.originalOptions,parent:n.node,path:n.path+"-"+r,propagateSelectionDown:n.propagateSelectionDown,propagateSelectionUp:n.propagateSelectionUp,ptm:w,selectionKeys:n.selectionKeys,selectionMode:n.selectionMode,togglerTemplate:n.togglerTemplate})}))):null,v=E(D(D({ref:x,className:i(n.node.className,T("node",{isLeaf:C})),style:n.node.style,tabIndex:r,role:"treeitem","aria-label":I,"aria-level":n.level,"aria-expanded":O,"aria-checked":a,"aria-setsize":n.node.children?n.node.children.length:0,"aria-posinset":n.index+1,onKeyDown:_},"aria-expanded",O),"aria-selected",a||l),N("node")),e.createElement("li",v,h,y));if(n.dragdropScope&&!n.disabled){var Oe=Ce(-1),we=n.last?Ce(1):null;return e.createElement(e.Fragment,null,Oe,De,we)}return De}));function R(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function F(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?R(Object(t),!0).forEach((function(n){D(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):R(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function J(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=X(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,a=!0,i=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return a=e.done,e},e:function(e){i=!0,l=e},f:function(){try{a||null==t.return||t.return()}finally{if(i)throw l}}}}function X(e,n){if(e){if("string"==typeof e)return B(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?B(e,n):void 0}}function B(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}L.displayName="UITreeNode";var V=e.memo(e.forwardRef((function(t,p){var s=o(),f=e.useContext(n),g=K.getProps(t,f),m=N(e.useState(""),2),y=m[0],v=m[1],b=N(e.useState(g.expandedKeys),2),x=b[0],S=b[1],E=e.useRef(null),C=e.useRef([]),I=e.useRef(null),D=e.useRef(!1),O=g.onFilterValueChange?g.filterValue:y,w=g.onToggle?g.expandedKeys:x,T=e.useRef(null),M=K.setMetaData({props:g,state:{filterValue:O,expandedKeys:w}}),P=M.ptm,j=M.cx;r(K.css.styles,M.isUnstyled,{name:"tree"});var A,U,R,X={filter:function(e){return ne(e)},reset:function(){return ae()}},B=function(e){var n=e.originalEvent,t=e.value,r=e.navigateFocusToChild;g.onToggle?g.onToggle({originalEvent:n,value:t}):(r&&(T.current=n),S(t))};A=function(){if(T.current){var e=T.current,n="toggler"===e.target.getAttribute("data-pc-section")?e.target.closest('[role="treeitem"]'):e.target,t=n.children[1].children[0];n.tabIndex="-1",t.tabIndex="0",t.focus(),T.current=null}},U=[w],R=e.useRef(!1),e.useEffect((function(){if(R.current)return A&&A();R.current=!0}),U);var V=function(e){I.current={path:e.path,index:e.index}},_=function(){I.current=null},H=function e(n){if(Array.isArray(n))return n.map(e);if(n&&Object.getPrototypeOf(n)===Object.prototype){var t={};for(var r in n)t[r]="data"!==r?e(n[r]):n[r];return t}return n},$=function(e){if(q(I.current.path,e.path)){var n=H(g.value),t=I.current.path.split("-");t.pop();var r=W(n,t),o=r?r.children[I.current.index]:n[I.current.index],l=W(n,e.path.split("-"));l.children?l.children.push(o):l.children=[o],r?r.children.splice(I.current.index,1):n.splice(I.current.index,1),g.onDragDrop&&g.onDragDrop({originalEvent:e.originalEvent,value:n,dragNode:o,dropNode:l,dropIndex:e.index})}},z=function(e){if(G(e)){var n=H(g.value),t=I.current.path.split("-");t.pop();var r=e.path.split("-");r.pop();var o=W(n,t),l=W(n,r),a=o?o.children[I.current.index]:n[I.current.index],i=Q(I.current.path,e.path);if(o?o.children.splice(I.current.index,1):n.splice(I.current.index,1),e.position<0){var c=i?I.current.index>e.index?e.index:e.index-1:e.index;l?l.children.splice(c,0,a):n.splice(c,0,a)}else l?l.children.push(a):n.push(a);g.onDragDrop&&g.onDragDrop({originalEvent:e.originalEvent,value:n,dragNode:a,dropNode:l,dropIndex:e.index})}},Y=function(e,n){return!!e&&(e!==n&&0!==n.indexOf(e))},q=function(e,n){return!!Y(e,n)&&!(e.indexOf("-")>0&&e.substring(0,e.lastIndexOf("-"))===n)},G=function(e){return!!Y(I.current.path,e.path)&&(-1!==e.position||!Q(I.current.path,e.path)||I.current.index+1!==e.index)},Q=function(e,n){return 1===e.length&&1===n.length||e.substring(0,e.lastIndexOf("-"))===n.substring(0,n.lastIndexOf("-"))},W=function e(n,t){if(0===t.length)return null;var r=parseInt(t[0],10),o=n.children?n.children[r]:n[r];return 1===t.length?o:(t.shift(),e(o,t))},Z=function(e){return!1!==e.leaf&&!(e.children&&e.children.length)},ee=function(e){13===e.which&&e.preventDefault()},ne=function(e){D.current=!0;var n=e.target.value;g.onFilterValueChange?g.onFilterValueChange({originalEvent:e,value:n}):v(n)},te=function(e){v(d.isNotEmpty(e)?e:""),re()},re=function(){if(D.current){if(d.isEmpty(O))C.current=g.value;else{C.current=[];var e,n=g.filterBy.split(","),t=O.toLocaleLowerCase(g.filterLocale),r="strict"===g.filterMode,o=J(g.value);try{for(o.s();!(e=o.n()).done;){var l=F({},e.value),a={searchFields:n,filterText:t,isStrictMode:r};(r&&(oe(l,a)||le(l,a))||!r&&(le(l,a)||oe(l,a)))&&C.current.push(l)}}catch(e){o.e(e)}finally{o.f()}}D.current=!1}},oe=function(e,n){if(e){var t=!1;if(e.children){var r=k(e.children);e.children=[];var o,l=J(r);try{for(l.s();!(o=l.n()).done;){var a=F({},o.value);le(a,n)&&(t=!0,e.children.push(a))}}catch(e){l.e(e)}finally{l.f()}}if(t)return e.expanded=!0,!0}},le=function(e,n){var t,r=n.searchFields,o=n.filterText,l=n.isStrictMode,a=!1,i=J(r);try{for(i.s();!(t=i.n()).done;){String(d.resolveFieldData(e,t.value)).toLocaleLowerCase(g.filterLocale).indexOf(o)>-1&&(a=!0)}}catch(e){i.e(e)}finally{i.f()}return(!a||l&&!Z(e))&&(a=oe(e,{searchFields:r,filterText:o,isStrictMode:l})||a),a},ae=function(){v("")};e.useImperativeHandle(p,(function(){return{props:g,filter:te,getElement:function(){return E.current}}}));var ie=function(n,t,r){return e.createElement(L,{hostName:"Tree",key:n.key||n.label,node:n,level:g.level+1,originalOptions:g.value,index:t,last:r,path:String(t),checkboxIcon:g.checkboxIcon,collapseIcon:g.collapseIcon,contextMenuSelectionKey:g.contextMenuSelectionKey,cx:j,disabled:g.disabled,dragdropScope:g.dragdropScope,expandIcon:g.expandIcon,expandedKeys:w,isNodeLeaf:Z,metaKeySelection:g.metaKeySelection,nodeTemplate:g.nodeTemplate,onClick:g.onNodeClick,onCollapse:g.onCollapse,onContextMenu:g.onContextMenu,onContextMenuSelectionChange:g.onContextMenuSelectionChange,onDoubleClick:g.onNodeDoubleClick,onDragEnd:_,onDragStart:V,onDrop:$,onDropPoint:z,onExpand:g.onExpand,onSelect:g.onSelect,onSelectionChange:g.onSelectionChange,onToggle:B,onUnselect:g.onUnselect,propagateSelectionDown:g.propagateSelectionDown,propagateSelectionUp:g.propagateSelectionUp,ptm:P,selectionKeys:g.selectionKeys,selectionMode:g.selectionMode,togglerTemplate:g.togglerTemplate})},ce=function(){g.filter&&(D.current=!0,re());var e=g.filter&&C.current?C.current:g.value;return e.map((function(n,t){return ie(n,t,t===e.length-1)}))},de=function(){if(g.filter){var n=d.isNotEmpty(O)?O:"",t=s({className:j("searchIcon")},P("searchIcon")),r=u.getJSXIcon(g.filterIcon||e.createElement(l,t),F({},t),{props:g}),o=s({className:j("filterContainer")},P("filterContainer")),a=s({type:"text",value:n,autoComplete:"off",className:j("input"),placeholder:g.filterPlaceholder,"aria-label":g.filterPlaceholder,onKeyDown:ee,onChange:ne,disabled:g.disabled},P("input")),i=e.createElement("div",o,e.createElement("input",a),r);if(g.filterTemplate)i=d.getJSXElement(g.filterTemplate,{className:"p-tree-filter-container",element:i,filterOptions:X,filterInputKeyDown:ee,filterInputChange:ne,filterIconClassName:"p-dropdown-filter-icon",props:g});return e.createElement(e.Fragment,null,i)}return null},ue=K.getOtherProps(g),pe=d.reduceKeys(ue,c.ARIA_PROPS),se=function(){if(g.loading){var n=s({className:j("loadingIcon")},P("loadingIcon")),t=g.loadingIcon||e.createElement(a,h({},n,{spin:!0})),r=u.getJSXIcon(t,F({},n),{props:g}),o=s({className:j("loadingOverlay")},P("loadingOverlay"));return e.createElement("div",o,r)}return null}(),fe=function(){if(g.value){var n=ce(),t=s(F({className:i(g.contentClassName,j("container")),role:"tree","aria-label":g.ariaLabel,"aria-labelledby":g.ariaLabelledBy,style:g.contentStyle},pe),P("container"));return e.createElement("ul",t,n)}return null}(),ge=function(){if(g.showHeader){var n=de(),t=n;if(g.header)t=d.getJSXElement(g.header,{filterContainerClassName:"p-tree-filter-container",filterIconClassName:"p-tree-filter-icon",filterInput:{className:"p-tree-filter p-inputtext p-component",onKeyDown:ee,onChange:ne},filterElement:n,element:t,props:g});var r=s({className:j("header")},P("header"));return e.createElement("div",r,t)}return null}(),me=function(){var n=d.getJSXElement(g.footer,g),t=s({className:j("footer")},P("footer"));return e.createElement("div",t,n)}(),he=s({ref:E,className:i(g.className,j("root")),style:g.style,id:g.id},K.getOtherProps(g),P("root"));return e.createElement("div",he,se,ge,fe,me)})));V.displayName="Tree";export{V as Tree};
